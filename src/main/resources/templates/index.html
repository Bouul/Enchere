<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <th:block th:replace="~{fragments/head :: uikit-head('Accueil')}"></th:block>
    <link rel="stylesheet" th:href="@{/vendor/eni-enchere/css/index.css}">
    <script th:src="@{/vendor/eni-enchere/js/index.js}"></script>

</head>
<body>
<nav th:replace="~{fragments/navbar :: navbar}"></nav>

<div class="uk-section uk-section-small">
    <div class="uk-container">
        <h2 class="uk-heading-divider">Filtres</h2>

        <!-- Non authentifié -->
        <div sec:authorize="!isAuthenticated()" class="uk-flex uk-flex-wrap uk-flex-middle uk-grid-small filter-group" uk-grid>
            <div class="uk-width-expand@s">
                <label for="categories">Catégories</label>
                <select id="categories" class="uk-select">
                    <option value="0">Toutes</option>
                    <option th:each="category : ${categories}" th:value="${category.categoryId}" th:text="${category.label}"></option>
                </select>
            </div>
            <div class="uk-width-expand@s">
                <label for="search">Nom contient</label>
                <input id="search" type="text" class="uk-input" placeholder="Rechercher...">
            </div>
            <div class="uk-width-expand@s">
                <label class="uk-hidden@s">&nbsp;</label> <!-- Pour aligner verticalement sur petits écrans -->
                <button id="search-button" class="uk-button uk-button-primary uk-width-1-1">Rechercher</button>
            </div>
        </div>

        <!-- Authentifié -->
        <div sec:authorize="isAuthenticated()" class="uk-flex uk-flex-wrap uk-flex-middle uk-grid-small filter-group" uk-grid>
            <div class="uk-width-expand@s">
                <label for="categories-auth">Catégories</label>
                <select id="categories-auth" class="uk-select">
                    <option value="0">Toutes</option>
                    <option th:each="category : ${categories}" th:value="${category.categoryId}" th:text="${category.label}"></option>
                </select>
            </div>
            <div class="uk-width-expand@s">
                <label for="search-auth">Nom contient</label>
                <input id="search-auth" type="text" class="uk-input" placeholder="Rechercher...">
            </div>
            <div class="uk-width-expand@s">
                <label for="filter-type">Mes enchères</label>
                <select id="filter-type" class="uk-select">
                    <option value="all">Toutes</option>
                    <option value="my-bids">En cours</option>
                    <option value="my-bidding">Mes mises</option>
                    <option value="my-wins">Remportées</option>
                </select>
            </div>
            <div class="uk-width-expand@s">
                <label class="uk-hidden@s">&nbsp;</label>
                <button id="search-button-auth" class="uk-button uk-button-primary uk-width-1-1 uk-margin-top">Rechercher</button>
            </div>
        </div>
    </div>
</div>

<div class="uk-section">
    <div class="uk-container">
        <div id="no-bids-message" class="uk-alert-warning uk-text-center" hidden>Aucune enchère disponible.</div>
        <div id="bids-container"></div>
    </div>
</div>
<div id="createdItemModal" class="uk-flex-top" uk-modal th:if="${showModal}">
    <div class="uk-modal-dialog uk-modal-body uk-margin-auto-vertical uk-card uk-card-default uk-card-hover uk-border-rounded
              uk-width-3-4@s uk-width-1-2@m uk-width-1-3@l">
        <button class="uk-modal-close-default" type="button" uk-close></button>

        <div class="uk-text-center uk-padding">
            <span class="uk-icon-button uk-margin-bottom" uk-icon="icon: check; ratio: 3" style="color: #60f050;"></span>
            <h2 class="uk-modal-title uk-text-success">Succès !</h2>
            <p class="uk-text-lead" th:text="'Votre enchère sur « ' + ${item.itemName} + ' » a été ajoutée.'"></p>

            <div class="uk-grid-small uk-child-width-auto uk-flex-center uk-text-left" uk-grid>
                <div><strong>Nom :</strong></div>
                <div th:text="${item.itemName}"></div>
                <div><strong>Description :</strong></div>
                <div th:text="${item.description}"></div>
                <div><strong>Début :</strong></div>
                <div th:text="${item.startDate}"></div>
                <div><strong>Fin :</strong></div>
                <div th:text="${item.endDate}"></div>
                <div><strong>Prix de départ :</strong></div>
                <div th:text="${item.startingPrice} + ' €'"></div>
                <div><strong>Catégorie :</strong></div>
                <div th:text="${category}"></div>
            </div>
        </div>

        <div class="uk-text-center uk-margin-top">
            <button class="uk-button uk-button-primary uk-modal-close" type="button">OK</button>
        </div>
    </div>
</div>
<script th:if="${showModal}">
    UIkit.modal('#createdItemModal').show();
</script>
</body>
</html>