<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: uikit-head('Détail Enchère')}"></head>
<body>
<nav th:replace="~{fragments/navbar :: navbar}"></nav>

<div class="uk-container uk-margin-large-top">
    <div th:if="${success}" class="uk-alert-success" uk-alert>
        <p th:text="${success}"></p>
    </div>
    <div th:if="${error}" class="uk-alert-danger" uk-alert>
        <p th:text="${error}"></p>
    </div>

    <div class="uk-card uk-card-default uk-card-body uk-box-shadow-large uk-border-rounded uk-animation-fade">

        <div class="uk-grid-large" uk-grid>
            <!-- Colonne gauche : image -->
            <div class="uk-width-1-3@s">
                <div th:if="${item.image != null}">
                    <img th:src="@{/images/{image}(image=${item.image})}" alt="Image de l'article"
                         class="uk-border-rounded uk-box-shadow-medium uk-width-1-1">
                </div>
                <div th:if="${item.image == null}">
                    <img src="https://picsum.photos/350" alt="Image non disponible"
                         class="uk-border-rounded uk-box-shadow-medium uk-width-1-1">
                </div>
            </div>

            <!-- Colonne droite : Infos détaillées -->
            <div class="uk-width-expand">
                <h1 class="uk-heading-medium uk-text-primary uk-margin-small-bottom" th:text="${item.itemName}">Nom de
                    l'article</h1>

                <dl class="uk-description-list uk-margin-remove-top uk-text-muted">

                    <dt><span uk-icon="icon: file-text"></span> Description</dt>
                    <dd class="uk-text-default" th:text="${item.description}">Aucune description</dd>

                    <dt><span uk-icon="icon: tag"></span> Catégorie</dt>
                    <dd class="uk-text-default" th:text="${item.category.label}">Catégorie</dd>

                    <dt><span uk-icon="icon: star"></span> Meilleure offre</dt>
                    <dd class="uk-text-default"
                        th:text="${highestBid != null ? highestBid.bidAmount + ' €' : 'Aucune enchère'}">0 €
                    </dd>

                    <dt><span uk-icon="icon: credit-card"></span> Mise à prix</dt>
                    <dd class="uk-text-default" th:text="${item.startingPrice + ' €'}">0 €</dd>

                    <dt><span uk-icon="icon: calendar"></span> Fin de l'enchère</dt>
                    <dd class="uk-text-default"
                        th:text="${item.endDate instanceof T(java.util.Date) ? #dates.format(item.endDate, 'dd/MM/yyyy') : item.endDate}">
                        Date
                    </dd>

                    <dt><span uk-icon="icon: location"></span> Retrait</dt>
                    <dd class="uk-text-default"
                        th:text="${item.pickupLocationBid.street + ', ' + item.pickupLocationBid.postalCode + ' ' + item.pickupLocationBid.city}">
                        Adresse
                    </dd>

                    <dt><span uk-icon="icon: user"></span> Vendeur</dt>
                    <dd class="uk-text-default" th:text="${item.seller.username}">Nom du vendeur</dd>
                </dl>
            </div>
        </div>

        <!-- Formulaire d'enchère -->
        <form th:action="@{/bidding}" method="post" class="uk-form-stacked uk-margin-large-top">
            <label class="uk-form-label" for="ma_proposition">Votre enchère (€) :</label>
            <div class="uk-form-controls">
                <input class="uk-input uk-border-rounded" type="number" id="ma_proposition" name="bidAmount"
                       placeholder="Entrez votre montant" required>
            </div>
            <input type="hidden" name="itemId" th:value="${item.itemId}">
            <button type="submit" class="uk-button uk-button-primary uk-border-rounded uk-margin-top uk-width-1-1">
                Enchérir
            </button>
        </form>

        <!-- Bouton retour -->
        <div class="uk-text-center uk-margin-top">
            <a th:href="@{/}" class="uk-button uk-button-default uk-border-rounded uk-width-1-1">Retour à l'accueil</a>
        </div>
    </div>
</div>

<!-- Optional: Fancybox pour lightbox image (ajoute aussi dans le head si tu veux) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5/dist/fancybox/fancybox.css">
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5/dist/fancybox/fancybox.umd.js"></script>

</body>
</html>
