<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">
<head>
    <th:block th:replace="~{fragments/head :: uikit-head('Profil Utilisateur')}"></th:block>
    <link rel="stylesheet" th:href="@{/vendor/eni-enchere/css/profile.css}">
</head>
<body>

<nav th:replace="fragments/navbar :: navbar"></nav>

<div class="uk-container uk-margin-large-top uk-margin-large-bottom">

    <!-- Header utilisateur -->
    <div class="uk-flex uk-flex-middle uk-flex-between uk-flex-wrap">
        <div class="uk-flex uk-flex-middle">
            <img src="/images/profile-picture.webp" alt="Avatar"
                 class="uk-border-circle uk-margin-right"
                 width="80" height="80">
            <div>
                <h3 class="uk-margin-remove" th:text="${user.username}">Pseudo</h3>
                <p class="uk-text-meta uk-margin-remove-top" th:text="${user.email}">email</p>
            </div>
        </div>
    </div>

    <!-- Progression du profil -->
    <div>
        <label class="uk-text-bold">Complétion du profil</label>
        <progress class="uk-progress" th:value="${profileCompletion}" max="100"></progress>
        <small class="uk-text-muted" th:text="'Votre profil est complété à ' + ${profileCompletion} + '%'"></small>
    </div>

    <hr>

    <!-- Infos utilisateur -->
    <div class="uk-grid-small uk-child-width-1-2@s uk-margin-top" uk-grid>
        <div><strong>Pseudo :</strong> <span th:text="${user.username}">Pseudo</span></div>
        <div><strong>Nom :</strong> <span th:text="${user.lastName}">Nom</span></div>
        <div><strong>Prénom :</strong> <span th:text="${user.firstName}">Prénom</span></div>
        <div><strong>Email :</strong> <span th:text="${user.email}">Email</span></div>
        <div><strong>Téléphone :</strong> <span th:text="${user.phone}">Téléphone</span></div>
        <div><strong>Rue :</strong> <span th:text="${user.street}">Rue</span></div>
        <div><strong>Code postal :</strong> <span th:text="${user.postalCode}">Code postal</span></div>
        <div><strong>Ville :</strong> <span th:text="${user.city}">Ville</span></div>
    </div>

    <!-- Bouton Modifier -->
    <div class="uk-text-center uk-margin-top">
        <a class="uk-button uk-button-primary uk-width-1-1"
           th:href="@{/profil/modifier(userId=${user.userId})}">
            Modifier mon profil
        </a>
    </div>

    <hr class="uk-margin-large-top uk-margin-large-bottom">

    <!-- Activité -->
    <div class="uk-margin-large-top">
        <h4 class="uk-heading-line"><span>Activité</span></h4>
        <div class="uk-grid-small uk-child-width-1-3@s" uk-grid>
            <div class="uk-card uk-card-default uk-card-body uk-text-center">
                <span class="uk-text-bold uk-text-large" th:text="${createdAuctions}">5</span><br>
                <span class="uk-text-meta">Enchères créées</span>
            </div>
            <div class="uk-card uk-card-default uk-card-body uk-text-center">
                <span class="uk-text-bold uk-text-large" th:text="${wonAuctions}">2</span><br>
                <span class="uk-text-meta">Enchères remportées</span>
            </div>
            <div class="uk-card uk-card-default uk-card-body uk-text-center">
                <span class="uk-text-bold uk-text-large" th:text="${activeAuctions}">3</span><br>
                <span class="uk-text-meta">Enchères en cours</span>
            </div>
        </div>
    </div>

</div>

<!-- Spinner lors du chargement -->
<div id="page-loader" class="uk-position-fixed uk-position-center" hidden>
    <div uk-spinner="ratio: 2"></div>
</div>

<script>
    // Affiche un loader au chargement de la page
    const loader = document.getElementById("page-loader");
    window.addEventListener("beforeunload", () => loader.removeAttribute("hidden"));
    window.addEventListener("load", () => loader.setAttribute("hidden", "true"));
</script>

</body>
</html>
